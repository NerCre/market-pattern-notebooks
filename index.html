<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>トレード判定＋学習＆トレードノート</title>
  <!-- Chart.js CDN for charts -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Style sheet -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1 class="app-title">トレード判定＋学習＆トレードノート</h1>
  <!-- Tab navigation -->
  <div class="tabs">
    <button class="tab-button active" data-tab="entry">📥 エントリー入力</button>
    <button class="tab-button" data-tab="result">✅ 結果入力</button>
    <button class="tab-button" data-tab="analysis">📊 一覧・分析</button>
  </div>
  <!-- Entry Tab -->
  <section id="tab-entry" class="tab-content active">
    <div class="app">
      <h2 class="entry-section-title">エントリー情報</h2>
      <div class="entry-grid">
        <!-- Basic Info Card -->
        <div class="card entry-basic">
          <h3 class="card-title">基本情報</h3>
          <div class="form-group">
            <label for="entry-symbol">銘柄</label>
            <input type="text" id="entry-symbol" name="symbol" placeholder="例: USD/JPY">
          </div>
          <div class="form-group">
            <label for="entry-timeframe">時間足</label>
            <select id="entry-timeframe" name="timeframe">
              <option value="1m">1分</option>
              <option value="5m">5分</option>
              <option value="15m">15分</option>
              <option value="1h">1時間</option>
              <option value="4h">4時間</option>
              <option value="1d">日足</option>
            </select>
          </div>
          <div class="form-group">
            <label for="entry-direction">方向</label>
            <select id="entry-direction" name="direction">
              <option value="long">ロング</option>
              <option value="short">ショート</option>
            </select>
          </div>
          <div class="form-group">
            <label for="entry-price">エントリー価格</label>
            <input type="number" step="0.0001" id="entry-price" name="entryPrice">
          </div>
          <div class="form-group">
            <label for="entry-stop">損切り価格</label>
            <input type="number" step="0.0001" id="entry-stop" name="stopLoss">
          </div>
          <div class="form-group">
            <label for="entry-target">利確価格</label>
            <input type="number" step="0.0001" id="entry-target" name="takeProfit">
          </div>
          <div class="form-group">
            <label for="entry-time">エントリー日時</label>
            <input type="datetime-local" id="entry-time" name="entryTime">
          </div>
          <div class="form-group">
            <label for="entry-pattern">パターン名/セットアップ</label>
            <input type="text" id="entry-pattern" name="pattern" placeholder="セットアップ名を入力">
          </div>
        </div>
        <!-- Indicators Card -->
        <div class="card entry-indicators">
          <h3 class="card-title">インジケーター</h3>
          <div class="form-group">
            <label for="indicator-ma">移動平均クロス</label>
            <select id="indicator-ma" name="indicatorMA">
              <option value="none">なし</option>
              <option value="golden">ゴールデンクロス</option>
              <option value="dead">デッドクロス</option>
            </select>
          </div>
          <div class="form-group">
            <label for="indicator-rsi">RSI 状態</label>
            <select id="indicator-rsi" name="indicatorRSI">
              <option value="normal">通常</option>
              <option value="overbought">買われ過ぎ</option>
              <option value="oversold">売られ過ぎ</option>
            </select>
          </div>
          <div class="form-group">
            <label for="indicator-macd">MACD シグナル</label>
            <select id="indicator-macd" name="indicatorMACD">
              <option value="none">なし</option>
              <option value="bullish">強気</option>
              <option value="bearish">弱気</option>
            </select>
          </div>
          <div class="form-group">
            <label for="indicator-bb">ボリンジャーバンド</label>
            <select id="indicator-bb" name="indicatorBB">
              <option value="center">センター</option>
              <option value="upper">上限に接触</option>
              <option value="lower">下限に接触</option>
            </select>
          </div>
        </div>
        <!-- Memo Card -->
        <div class="card entry-memo">
          <h3 class="card-title">メモ・添付</h3>
          <div class="form-group">
            <label for="entry-memo-text">メモ</label>
            <textarea id="entry-memo-text" name="memo" rows="5" placeholder="考えや理由を記録"></textarea>
          </div>
          <div class="form-group">
            <label for="entry-screenshot">画像を添付</label>
            <input type="file" id="entry-screenshot" name="screenshot" accept="image/*">
          </div>
          <div class="form-group">
            <label for="entry-audio">音声を添付</label>
            <input type="file" id="entry-audio" name="audio" accept="audio/*">
          </div>
        </div>
      </div>
      <div class="entry-actions button-row">
        <button class="btn btn-secondary" id="judge-only">判定する</button>
        <button class="btn btn-primary" id="judge-and-save">判定してエントリーを保存</button>
      </div>
      <div class="card judge-result" id="judge-result-panel" style="display:none">
        <h3 class="card-title">判定結果</h3>
        <div id="judge-content"></div>
      </div>
    </div>
  </section>
  <!-- Result Tab -->
  <section id="tab-result" class="tab-content">
    <div class="app">
      <h2 class="result-section-title">結果入力</h2>
      <div class="result-grid">
        <!-- Left: List of entries to select -->
        <div class="card result-list">
          <h3 class="card-title">エントリー選択</h3>
          <div id="no-entry-message" style="display:none">エントリーデータがありません。</div>
          <ul id="entry-list" class="entry-list"></ul>
        </div>
        <!-- Right: result form -->
        <div class="card result-form">
          <h3 class="card-title">決済情報</h3>
          <div id="selected-entry-info" style="margin-bottom:10px; color:#9aa4b5;"></div>
          <div class="form-group">
            <label for="result-exit-time">決済日時</label>
            <input type="datetime-local" id="result-exit-time" name="exitTime">
          </div>
          <div class="form-group">
            <label for="result-exit-price">決済価格</label>
            <input type="number" step="0.0001" id="result-exit-price" name="exitPrice">
          </div>
          <div class="form-group">
            <label for="result-notes">結果メモ</label>
            <textarea id="result-notes" name="resultMemo" rows="4" placeholder="結果に関するメモ"></textarea>
          </div>
          <div class="profit-display" id="profit-display">損益: 0</div>
        </div>
      </div>
      <div class="button-row">
        <button class="btn btn-primary" id="save-result">結果を保存</button>
      </div>
    </div>
  </section>
  <!-- Analysis Tab -->
  <section id="tab-analysis" class="tab-content">
    <div class="app">
      <h2 class="analysis-section-title">一覧・分析</h2>
      <!-- Filters and Table -->
      <div class="card">
        <div class="filter-row">
          <div class="form-group">
            <label for="filter-symbol">銘柄</label>
            <select id="filter-symbol">
              <option value="">すべて</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filter-timeframe">時間足</label>
            <select id="filter-timeframe">
              <option value="">すべて</option>
              <option value="1m">1分</option>
              <option value="5m">5分</option>
              <option value="15m">15分</option>
              <option value="1h">1時間</option>
              <option value="4h">4時間</option>
              <option value="1d">日足</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filter-direction">取引区分</label>
            <select id="filter-direction">
              <option value="">すべて</option>
              <option value="long">ロング</option>
              <option value="short">ショート</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filter-date-from">日付開始</label>
            <input type="date" id="filter-date-from">
          </div>
          <div class="form-group">
            <label for="filter-date-to">日付終了</label>
            <input type="date" id="filter-date-to">
          </div>
          <div class="form-group">
            <button class="btn btn-secondary" id="apply-filter" style="margin-top: 24px;">フィルタ適用</button>
          </div>
        </div>
        <div class="table-card">
          <table class="trade-table" id="trade-table">
            <thead>
              <tr>
                <th>ID</th>
                <th>日時</th>
                <th>銘柄</th>
                <th>時間足</th>
                <th>方向</th>
                <th>結果</th>
                <th>損益</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
      <!-- Charts -->
      <div class="charts-column">
        <div class="card">
          <h3 class="card-title">累積損益</h3>
          <canvas id="cum-profit-chart"></canvas>
        </div>
        <div class="card">
          <h3 class="card-title">ロング/ショート勝率・平均損益</h3>
          <canvas id="long-short-chart"></canvas>
        </div>
        <div class="card">
          <h3 class="card-title">時間足別勝率</h3>
          <canvas id="timeframe-chart"></canvas>
        </div>
      </div>
      <!-- Export/Import -->
      <div class="export-import-row">
        <button class="btn btn-secondary" id="export-json">JSONエクスポート</button>
        <label class="btn btn-secondary" for="import-json">JSONインポート
          <input type="file" id="import-json" accept="application/json" hidden>
        </label>
      </div>
    </div>
  </section>
  <!-- Script file -->
  <script src="script.js"></script>
</body>
</html>